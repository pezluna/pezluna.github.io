---
layout: forensic
title: 파일 시스템 구조 (1)
url : test
---

# 섹터와 클러스터란?
섹터와 클러스터는 컴퓨터가 파일들을 더욱 효과적으로 관리하기 위한 하나의 묶음이다. 디스크 내에서의 읽기 및 쓰기 작업에서는 섹터, 일반적으로 512바이트단위로 연산이 진행된다. 그러나 데이터의 입출력은 섹터 단위로 진행하기에는 너무나 시간이 오래걸리게 된다. 따라서 섹터들을 다시 하나로 묶어 클러스터라는 단위를 만들어냈다. 클러스터는 보통 4096바이트의 크기를 가진다.

# 파일 시스템
저장 매체의 발달에 따라, 수많은 파일들을 효과적으로 관리해야할 필요성이 급증하였다. 이에 발맞추어 다양한 방식의 파일 시스템이 등장하였다. 아래는 대표적 파일 시스템들이다.

* FAT16
* FAT32
* NTFS
* ext3
* ext4

파일 시스템에 따라 파일이 저장되어지는 방식도 천차만별이며, OS에 따라서도 파일 시스템이 결정되기도 한다. 다양한 파일 시스템에 대해 알아두어야 적재적소에 활용할 수 있을 것이다.

# MBR
MBR은 Master Boot Record의 약자로, 디스크의 맨 앞에 위치하여 부팅을 성공적으로 수행할 수 있도록 도와주는 역할을 한다. 부팅을 하기 위한 파티션의 위치와 파티션의 파일 시스템의 종류 등이 기록되어있기에, 파티션 섹터 혹은 마스터 파티션 테이블이라고도 불리운다.

## MBR의 구조
MBR은 총 512바이트(1섹터) 길이이며, 총 4개의 주 파티션에 대한 정보가 저장되어있다. 만일 이보다 더 많은 수의 파티션이 디스크에 기록되어져있을 경우, 주 파티션이 아닌 확장 파티션으로서 취급되어진다.  
MBR은 446바이트의 부트코드와 64바이트의 파티션 테이블이 포함되어지며, 항상 시그니쳐 코드인 0x55AA로 마무리되어진다. 이 때, 64바이트의 파티션 테이블은 다시 16바이트씩으로 나누어져 4개의 주 파티션의 정보를 기록한다.  

## 파티션 테이블
각 파티션 테이블은 16바이트의 길이로 기록되어져있다. 첫 1바이트는 해당 파티션으로 부트가 가능한지의 여부를 나타내는데, 이를 부트 플래그라고 부른다. 부트 플래그가 0x80이면 부트가 가능한 파티션이라는 뜻이다.  
그 뒤 나오는 3바이트는 CHS 시작 주소를 나타내나, 이는 최근 잘 사용되지 않기에 넘어가도록 한다.  
CHS 시작 주소 뒤의 1바이트는 해당 파티션의 파일 시스템 종류를 나타낸다. 대표적인 코드들은 다음과 같다.  

* FAT32 : 0x0C(LBA addr), 0x0B(CHS addr)
* NTFS : 0x07
* Extended : 0x05  

이 뒤의 3바이트 또한 CHS 끝 주소를 나타내므로 아직 크게 신경을 쓸 필요가 없다.  
그 다음 나오는 4바이트의 값은 LBA 주소로, CHS 방식이 사용되지 않고 LBA 방식을 사용하는 파티션의 시작 위치를 나타낸다.  
그리고 마지막 4바이트는 파티션 섹터의 크기를 나타내며, 이렇게 총 16바이트의 길이로 한 파티션의 개요가 파티션 테이블에 저장되어진다.

***
참고 자료 : https://blog.naver.com/s2kiess
